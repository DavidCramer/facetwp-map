!function(a){function b(){h=a("#snazzy-tags"),i=a("#snazzy-colors"),sort=a("#snazzy-order"),text=a("#snazzy-search"),n=a("#current-page-selector-top"),p=[],i.val()&&p.push("color="+i.val()),h.val()&&p.push("tag="+h.val()),sort.val()&&p.push("sort="+sort.val()),text.val()&&p.push("text="+text.val()),n.val()&&p.push("page="+n.val()),a(".facetwp_map-snazzy-item").animate({opacity:.6},500),a.getJSON("https://snazzymaps.com/explore.json?key="+g.val()+"&pageSize=6&"+p.join("&"),function(b){k.html(j(b)),b.pagination&&(m=b.pagination,m.currentPage===m.totalPages?a(".next-page, .last-page").hide():a(".next-page, .last-page").show(),1===m.currentPage?a(".prev-page, .first-page").hide():a(".prev-page, .first-page").show())})}function c(){g.val().length?d():(f.html(""),k.html(""))}function d(){var d=Handlebars.compile(a("#snazzy-filters-tmpl").html());a(document).off("facetwp_map.save",c),a.getJSON("https://snazzymaps.com/types.json?key="+g.val(),function(g){f.html(d(g)),b(),p=[],g.message?a(document).on("facetwp_map.save",c):a(document).off("facetwp_map.init",e)})}function e(){f=a("#facetwp_map-snazzy-filters"),g=a("#fwp_map-map_style-snazzy-control"),l=a("#fwp_map-map_style-styles-control"),j=Handlebars.compile(a("#snazzy-item-tmpl").html()),k=a("#facetwp_map-snazzy-results"),g.val().length&&d()}var f,g,h,i,j,k,l,m,n,o=0,p=[];a(document).on("facetwp_map.init",e),a(document).on("change",".facetwp_map-snazzy select, .facetwp_map-snazzy input",function(){a(".current-page").val(1),b()}),a(document).on("facetwp_map.save",c),a(document).on("click",".facetwp-snazzy-apply",function(){var b=a(this),c=b.data("json");o=b.data("id"),"object"==typeof c&&(c=JSON.stringify(c)),b.html(b.data("text")).addClass("button-primary"),l.val(c).trigger("change"),a(".current-style").removeClass("current-style").find(".facetwp-snazzy-apply").removeClass("button-primary").html("Use Style").prop("disabled",!1),a(".snazzy-id-"+o).addClass("current-style").find(".facetwp-snazzy-apply").html("Current Style").prop("disabled",!0)}),a(document).on("click",".pagination-links > a",function(c){var d=a(this);if(c.preventDefault(),d.hasClass("first-page")&&m.currentPage>1)a(".current-page").val(1);else if(d.hasClass("prev-page")&&m.currentPage>1)a(".current-page").val(m.currentPage-1);else if(d.hasClass("next-page")&&m.currentPage<m.totalPages)a(".current-page").val(m.currentPage+1);else{if(!(d.hasClass("last-page")&&m.currentPage<m.totalPages))return;a(".current-page").val(m.totalPages)}b()})}(jQuery);